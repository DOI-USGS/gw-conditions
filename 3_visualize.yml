target_default: 3_visualize

packages:
  - dplyr
  - sf
  - xml2
  - jsonlite 
  - data.table
  - stringr

sources:
  - 3_visualize/src/build_peaks_svg.R
  - 3_visualize/src/svg_utils_general.R
  - 3_visualize/src/svg_utils_mapping.R
  - 3_visualize/src/svg_utils_paths.R
  - 3_visualize/src/svg_utils_vue.R
  - 3_visualize/src/sf_utils_shift.R

targets:

  3_visualize:
    depends:
      - src/assets/anomaly_peaks.svg 
      - public/gw-conditions-site-coords.csv ## this is in aws as gw-conditions-sites.csv
      - public/gw-conditions-wy20.csv ## in aws as gw-conditions-wy20.csv
      - public/gw-conditions-daily-proportions.csv ## in aws as gw-conditions-daily-count.csv

  # exports that are leveraged by vue
  # TODO: send to s3
  src/assets/anomaly_peaks.svg:
    command: build_peaks_svg(
      target_name, 
      svg_width = svg_width, 
      svg_height = svg_height)
      
  public/gw-conditions-wy20.csv:
    command: gwl_to_peak(
      target_name, 
      gw_anomaly_data_w_colors)
    
  public/gw-conditions-site-coords.csv:
    command: get_site_coords(
      target_name,
      sites_sf = gw_sites_sf)
  
  public/gw-conditions-daily-proportions.csv:
    command: site_prop_timeseries(target_name, 
      gw_anomaly_data_w_colors)

      

